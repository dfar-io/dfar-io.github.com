<!doctype html><html><head>
<meta charset=utf-8>
<meta name=viewport content="width=device-width,initial-scale=1">
<meta name=description content="Software/DevOps Engineer">
<link rel="shortcut icon" href=https://dfar.io/favicon.ico>
<link rel=stylesheet href=/css/style.min.css>
<title>Adding Entity Framework/SQL Server to a Function App</title>
</head>
<body><header id=banner>
<h2><a href=https://dfar.io/>Dave Farinelli</a></h2>
<nav>
<ul>
<li>
<a href=/about/ title=about>about</a>
</li>
</ul>
</nav>
</header>
<main id=content>
<article>
<header id=post-header>
<h1>Adding Entity Framework/SQL Server to a Function App</h1><time>September 1, 2019</time></header><p>When working with function apps, you may want to connect SQL Server to allow for using an API with data persistence.</p>
<h2 id=setting-up-project-to-use-entity-framework>Setting up Project to Use Entity Framework</h2>
<p>Add the following to your <code>.csproj</code> file, in the section with <code>PackageReference</code> entries:</p>
<p>And then add the following to allow for copying the project DLL (supports builds in both Windows and Linux):</p>
<p>For setting this up, I’d recommend having at least one Model ready for use. In our case, let’s use a simple example with <code>Entry.cs</code>:</p>
<p>Now create the <code>Context.cs</code> and <code>ContextFactory.cs</code> files in the Models folder:</p>
<p>Now create a <code>Startup.cs</code> file in root:</p>
<h2 id=setting-up-database>Setting up Database</h2>
<p>Finally, you’ll need to set up a database for use. Create the database and use the connection string – let’s use SQL Server locally and set this in the Azure Function project’s <code>local.settings.json</code>:</p>
<p>Once this is set, setting up migrations is the next step. Set the environment variable on your PC:</p>
<p>With this step done, start the application and check to see if your database was updated correctly, and that you can see the tables desired.</p>
</article>
</main><footer id=footer>
</footer>
</body>
</html>