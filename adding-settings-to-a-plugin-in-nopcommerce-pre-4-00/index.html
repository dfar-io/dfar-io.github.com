<!doctype html><html><head>
<meta charset=utf-8>
<meta name=viewport content="width=device-width,initial-scale=1">
<meta name=description content="Software/DevOps Engineer">
<link rel="shortcut icon" href=https://dfar.io/favicon.ico>
<link rel=stylesheet href=/css/style.min.css>
<title>Adding Settings to a Plugin in NopCommerce (pre-4.00)</title>
</head>
<body><header id=banner>
<h2><a href=https://dfar.io/>Dave Farinelli</a></h2>
<nav>
<ul>
<li>
<a href=/about/ title=about>about</a>
</li>
</ul>
</nav>
</header>
<main id=content>
<article>
<header id=post-header>
<h1>Adding Settings to a Plugin in NopCommerce (pre-4.00)</h1><time>April 30, 2020</time></header><p>Once you’re created a plugin for NopCommerce, you’ll likely want to add the ability to configure settings inside the plugin for reference later.</p>
<p>When adding this capability, we’re going to work on trying to make this as immutable as possible, to follow functional programming as best we can, just because it makes things a little cleaner and puts all of the conversion between the configuration model and settings object.</p>
<h3 id=locale-keys>Locale Keys</h3>
<p>First, we’ll set up a class called <code>MyPluginLocaleKeys.cs</code> that holds the different locale keys used to represent the settings descriptions in the Configure page:</p>
<h3 id=configuration-model>Configuration Model</h3>
<p>Next, we’ll create a configuration model named <code>Models/MyPluginConfigModel.cs</code> that represents the configure page for the plugin. This will get populated by the plugin’s settings, and then be responsible for receiving user data and saving the setting values provided.</p>
<p>In addition to usually having a 1:1 relationship to the plugin settings, you can also provide DataAnnotations that handle model validity and display names. When providing a <code>NopResourceDisplayName</code>, we’ll use the locale key provided above.</p>
<h3 id=settings-object>Settings Object</h3>
<p>Next, create an ISettings implementation in the root of the plugin named <code>MyPluginSettings.cs</code>.</p>
<p>This is going to work a little differently – we’re going to create this to be immutable, so we’ll both initialize it from a config model, create a “default” settings object, and allow for easily converting to a config model.</p>
<p>We use <code>private set</code> here to make sure we initialize the settings object from a configuration model (when saving) and disallow the ability to change the settings object – making it immutable.</p>
<h3 id=base-plugin-class>Base Plugin Class</h3>
<p>Next, create the base plugin class (named <code>MyPluginPlugin.cs</code>, so for example, <code>EnhancedLoggingPlugin.cs</code>, used for defining the type of plugin and defining the install/uninstall options. We’ll do a few special things</p>
<h3 id=configure-controller-and-view>Configure Controller and View</h3>
<p>The final step is creating both the Configuration controller and view to finish the ability to view and save plugin settings data. Create the <code>Controllers/MyPluginConfigController.cs</code> file:</p>
<p>Then create the <code>Views/Configure.cshtml</code> file:</p>
<blockquote>
</blockquote>
</article>
</main><footer id=footer>
</footer>
</body>
</html>