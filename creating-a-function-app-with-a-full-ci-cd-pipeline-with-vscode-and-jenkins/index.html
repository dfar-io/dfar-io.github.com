<!doctype html><html><head>
<meta charset=utf-8>
<meta name=viewport content="width=device-width,initial-scale=1">
<meta name=description content="Software/DevOps Engineer">
<link rel="shortcut icon" href=https://dfar.io/favicon.ico>
<link rel=stylesheet href=/css/style.min.css>
<title>Creating a Function App With a Full CI/CD Pipeline with VSCode and Jenkins</title>
</head>
<body><header id=banner>
<h2><a href=https://dfar.io/>Dave Farinelli</a></h2>
<nav>
<ul>
<li>
<a href=/about/ title=about>about</a>
</li>
</ul>
</nav>
</header>
<main id=content>
<article>
<header id=post-header>
<h1>Creating a Function App With a Full CI/CD Pipeline with VSCode and Jenkins</h1><time>July 1, 2019</time></header><p>Before starting this, you’ll need to have a few things on your machine:</p>
<ul>
<li><a href=vscode:extension/ms-azuretools.vscode-azurefunctions>Azure Functions VSCode Extension</a></li>
<li>Azure Functions Core Tools (<code>choco install azure-functions-core-tools</code>)</li>
<li>.NET Core Build Tools (<code>choco install visualstudio2017-workload-netcorebuildtools</code>)</li>
<li>An Azure subscription</li>
<li>A Function app created inside of the Azure subscription</li>
<li>A Jenkins server with the following set up:
<ul>
<li>Azure Function plugin installed</li>
<li>A service principal configured (use <code>az ad sp create-for-rbac -n "jenkins" --role contributor --scopes /subscriptions/{SubID}</code> and then add to Jenkins Credentials)</li>
</ul>
</li>
</ul>
<h2 id=creating-and-locally-running-the-function-app>Creating and Locally Running the Function App</h2>
<p>Inside VSCode, create a function app project with the following:</p>
<ul>
<li>Create a new folder for use</li>
<li>Language: C#</li>
<li>Template: HttpTrigger</li>
<li>Security: Anonymous</li>
</ul>
<p>After creating, you’ll need to resolve a few dependencies, which VSCode should prompt for.</p>
<p>I ran into issues with getting the function app debugging locally, but I was able to run it without issue by running the following in PowerShell</p>
<p>Once you get it running, you can use the URL provided to test:</p>
<p> </p>
<h3 id=locally-running-a-timertrigger-function>Locally Running a TimerTrigger Function</h3>
<p>To use a TimerTrigger functions, there are just a few changes:</p>
<ul>
<li>You will need to have a Storage Account available to allow for running locally.</li>
<li>When running, you can invoke the function by making a POST to <code>http://localhost:7071/admin/functions/{FUNCTION_NAME}</code> <em>(make sure to provide an empty JSON body in the payload)</em></li>
</ul>
<h2 id=adding-to-git-and-deploying-via-jenkins>Adding to Git and Deploying via Jenkins</h2>
<p>The next step is checking in the example code to Git, so you have a place to get the codebase from for deployment.</p>
<p>After checking in the codebase, create a Multibranch Pipeline project in Jenkins.</p>
<p>Use the following Jenkinsfile as a reference:</p>
<p>After that, check in your codebase and you should have a deployed Function App with the codebase provided. Verify it using the Function App URL provided.</p>
</article>
</main><footer id=footer>
</footer>
</body>
</html>