<!doctype html><html><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Software/DevOps Engineer"><link rel="shortcut icon" href=https://dfar.io/favicon.ico><link rel=stylesheet href=/css/style.min.css><title>Restricting Access to App Services and Function Apps</title></head><body><header id=banner><h2><a href=https://dfar.io/>Dave Farinelli</a></h2><nav><ul><li><a href=/about/ title=about>about</a></li></ul></nav></header><main id=content><article><header id=post-header><h1>Restricting Access to App Services and Function Apps</h1><time>June 19, 2020</time></header><h2 id=restrict-by-function>Restrict By Function</h2><p>Restriction by function works well since it gives you granular control over functions. An appropriate application would be giving the key to other applications, and then having those applications use the key to access.</p><p>There are three levels to restrict a function:</p><ul><li>Anonymous – no restrictions</li><li>Function – restricted by an individual function key</li><li>Admin – uses the admin key defined in the function app</li></ul><p>When calling the function, there are two ways to do so, using either a query string:</p><p>Or using the <code>x-functions-key</code> header.</p><h2 id=restrict-by-application>Restrict by Application</h2><h3 id=restrict-by-ip>Restrict By IP</h3><p>For Azure App Services and Function Apps, you can restrict access to them based on IP address – useful for building internal applications with limited access.</p><p>First, click <strong>Networking</strong> on the left sidebar, then open the <strong>Access Restrictions</strong> page.</p><p>From here, you can add and remove IP addresses for both the App service/Function App and the SCM page. If no IP addresses are listed, then access is open for all.</p><p>Any invalid IP addresses at this point will receive a 403:</p><p></p><p>If you need a list of the IPs trying to access the application, you can access:</p><ul><li>App Service: Diagnose and solve problems -> Availabilty and Performance -> HTTP 4xx Errors</li><li>Function App: Diagnose and solve problems -> HTTP 4xx Errors -> HTTP 4xx Errors</li></ul><p>Once here, scroll to the bottom of the page and expand <strong>Which client IPs got rejected due to IP restriction?</strong>:</p><p></p><h3 id=app-service-authentication>App Service Authentication</h3><p>App Service Authentication works well when working with an application that is accessed by a browser (so not an API). Note that without authentication, you’ll need to login before accessing the app at all.</p><p>First, turn on App Service Authentication:</p><p></p><p>For setting up the source, setting up Azure Active Directory allows for using users inside the tenant for access. Useful for setting up an internal application.</p></article></main><footer id=footer></footer></body></html>