<!doctype html><html><head>
<meta charset=utf-8>
<meta name=viewport content="width=device-width,initial-scale=1">
<meta name=description content="Software/DevOps Engineer">
<link rel="shortcut icon" href=https://dfar.io/favicon.ico>
<link rel=stylesheet href=/css/style.min.css>
<title>Set up nopCommerce 4.2 on a Linux Azure VM</title>
</head>
<body><header id=banner>
<h2><a href=https://dfar.io/>Dave Farinelli</a></h2>
<nav>
<ul>
<li>
<a href=/about/ title=about>about</a>
</li>
</ul>
</nav>
</header>
<main id=content>
<article>
<header id=post-header>
<h1>Set up nopCommerce 4.2 on a Linux Azure VM</h1><time>March 9, 2020</time></header><h2 id=infrastructure-setup>Infrastructure Setup</h2>
<p>First, create a Ubuntu-based VM, opening ports 80, 443, and 22.</p>
<p>Afterwards, create an Azure SQL Database.</p>
<h2 id=vm-configuration>VM Configuration</h2>
<p>Once all of the infrastructure is created, set up a DNS record for the public IP created for the VM to make access easier.</p>
<p>Next, SSH into the VM using the domain name created above. Run the following commands to install the .NET Core runtime and SDK:</p>
<p>Next, install and enable nginx:</p>
<p>Edit <code>/etc/nginx/sites-available/default</code>:</p>
<p>Finally, restart NGINX:</p>
<h2 id=set-up-nopcommerce>Set up NopCommerce</h2>
<p>This step will lay out the process of downloading the NoSource version of nopCommerce and getting it running.</p>
<p>If you have a custom copy of nopCommerce from source, you would publish it and use the output here instead.</p>
<p>If starting from scratch, run the following:</p>
<p>Now create the nopCommerce service by creating file <code>/etc/systemd/system/nop.service</code>:</p>
<p>Enable the above service:</p>
<p>Once this is all set, you should be able to install the store, using the Azure SQL Database created above. When installing, you may want to use the connection string provided by Azure:</p>
<p> </p>
<p>While installing, you’ll likely see a 504 timeout from NGINX – this is okay, just give some time for the installation to finish, and you should be able to eventually see the store front.</p>
<h2 id=set-up-ssl-using-let8217s-encrypt>Set up SSL using Let’s Encrypt</h2>
<p>To set up Let’s Encrypt, follow the <a href=https://certbot.eff.org/lets-encrypt/ubuntubionic-nginx>Certbot</a> directions, making sure <strong>to enable auto-redirect.</strong></p>
<p>Afterwards, make the following change to the <strong>appsettings.json</strong> file:</p>
<p>Restart the NopCommerce service and ensure you can view the front page without an SSL warning.</p>
</article>
</main><footer id=footer>
</footer>
</body>
</html>