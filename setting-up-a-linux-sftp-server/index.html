<!doctype html><html><head>
<meta charset=utf-8>
<meta name=viewport content="width=device-width,initial-scale=1">
<meta name=description content="Software/DevOps Engineer">
<link rel="shortcut icon" href=https://dfar.io/favicon.ico>
<link rel=stylesheet href=/css/style.min.css>
<title>Setting up a Linux SFTP Server</title>
</head>
<body><header id=banner>
<h2><a href=https://dfar.io/>Dave Farinelli</a></h2>
<nav>
<ul>
<li>
<a href=/about/ title=about>about</a>
</li>
</ul>
</nav>
</header>
<main id=content>
<article>
<header id=post-header>
<h1>Setting up a Linux SFTP Server</h1><time>September 6, 2019</time></header><p>To get started, you’ll need to use the following:</p>
<ul>
<li>A virtual machine with a public IP address.</li>
<li>SSH address to the above virtual machine</li>
</ul>
<h2 id=configuring-the-user>Configuring the User</h2>
<p>First, SSH into the server and install OpenSSH:</p>
<p><code>sudo apt install -y ssh openssh-server</code></p>
<p>Now create the group to have access, alongside a user to be able to access:</p>
<p>Now set up the directories to allow for the following:</p>
<ul>
<li>The user can view the contents of their own folder.</li>
<li>The user can upload files to the <code>uploads/</code> folder.</li>
</ul>
<h2 id=setting-up-user-access>Setting up User Access</h2>
<p>There are two ways to have the user access – by key or by password. Key is preferred in production scenarios as it’s overall more secure.</p>
<h3 id=by-key>By Key</h3>
<p>Basically, you will be storing the public key on the FTP server, and the client connecting into the server will use the associated private key. Easiest way is to have the client generate a public/private key pair and then add the public key to <code>/home/ftpuser/.ssh/authorized_keys</code>.</p>
<p>Once that’s done, make sure the <code>ftpuser</code> user has ownership of the <code>authorized_keys</code> file.</p>
<h3 id=by-password>By Password</h3>
<p>To allow for password, just use the following command:</p>
<h2 id=setting-up-sftp>Setting up SFTP</h2>
<p>To set up SFTP, append the following to the end of <code>/etc/ssh/sshd_config</code>:</p>
<p>As you’re using a password to authenticate the above user, make sure the following is in the file as well:</p>
<p><code>PasswordAuthentication yes</code></p>
<p>Restart the service:</p>
<p><code>&lt;code>sudo systemctl restart sshd</code></p>
<h2 id=verification>Verification</h2>
<p>To verify everything is in place, try logging into the server as the new user:</p>
<p><code>&lt;code>sftp ftpuser@YOUR_DOMAIN</code></p>
<p>Once connected in, try uploading a file:</p>
<p><code>PUT D:/local-file.png file.png</code></p>
<p>And then check that the file is there:</p>
<p><code>GET file.png D:/downloaded-file.png</code></p>
</article>
</main><footer id=footer>
</footer>
</body>
</html>