<!doctype html><html><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Software/DevOps Engineer"><link rel="shortcut icon" href=https://dfar.io/favicon.ico><link rel=stylesheet href=/css/style.min.css><title>Setting up Artifactory to use a root domain with a Reverse Proxy</title></head><body><header id=banner><h2><a href=https://dfar.io/>Dave Farinelli</a></h2><nav><ul><li><a href=/about/ title=about>about</a></li></ul></nav></header><main id=content><article><header id=post-header><h1>Setting up Artifactory to use a root domain with a Reverse Proxy</h1><time>September 5, 2019</time></header><p>When installing Artifactory, you’ll be able to start using it as `http://YOUR_DOMAIN:8081/artifactory. To change this to a simpler domain, you can read the following guide. You’ll need to have the following:</p><ul><li>Artifactory administrative access</li><li>SSH access to the server.</li></ul><h2 id=setting-up-reverse-proxy-to-simplify-domain>Setting up Reverse Proxy to Simplify Domain</h2><p>First, SSH into the server and install Apache:</p><p>This should create a default page you can access by hitting the root URL:</p><p></p><p>Now configure the appropriate modules:</p><p><code>sudo a2enmod proxy_http proxy_ajp rewrite deflate headers proxy_balancer proxy_connect proxy_html ssl lbmethod_byrequests slotmem_shm proxy</code></p><p>While logged in as an admin in Artifactory, access <code>Admin -> HTTP Settings</code> and make the following changes:</p><p></p><p>After saving, you’ll see the ability to View/Download the configuration on the right side of the page. Download the contents and replace the contents of <code>/etc/apache2/sites-enabled/000-default.conf</code> on the Artifactory server with them.</p><p>Restart Apache with <code>sudo systemctl restart apache2</code>.</p><p>Now confirm that you can request Artifactory using http://YOUR_DOMAIN.</p><h2 id=setting-up-ssl-using-let8217s-encrypt>Setting up SSL using Let’s Encrypt</h2><p>Now that you can access the domain, let’s secure the domain using Let’s Encrypt.</p><p>Use the following to check which version of Linux you’re running: <code>&lt;code>lsb_release -a</code></p><p>Most likely, you’ll be using Ubuntu 18.04, if so, you can use these steps. If not, check out the CertBot page for appropriate directions.</p><p>You should be able to generate and configure the cert automatically running the directions above. Assuming this is successful, select to <strong>redirect HTTP traffic to HTTPS, removing HTTP access.</strong></p><p>Now confirm that you can both:</p><ol><li>Access the HTTPS version of your domain above.</li><li>When trying to access HTTP, it automatically redirects to HTTPS.</li></ol><p>Reference: <a href=https://www.jfrog.com/confluence/display/RTF/Configuring+Apache>https://www.jfrog.com/confluence/display/RTF/Configuring+Apache</a></p></article></main><footer id=footer></footer></body></html>